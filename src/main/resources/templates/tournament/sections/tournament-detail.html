<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/base}">
<head>
    <title th:text="${tournament.tenGiai + ' - BTMS'}">Chi tiết Giải đấu - BTMS</title>
    
    <!-- Page-specific CSS -->
    <th:block layout:fragment="page-css">
        <!-- Swiper CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
        <link rel="stylesheet" th:href="@{/css/tournament/tournament-detail.css}">
        <link rel="stylesheet" th:href="@{/css/tournament/tournament-bracket.css}">
    </th:block>
</head>

<body>
    <div layout:fragment="content" class="tournament-detail-page">
        <!-- Hero Section with Parallax -->
        <div class="hero-section" id="heroSection" data-aos="fade">
            <div class="hero-background parallax-bg" 
                 th:style="${tournament.hinhAnh != null and tournament.hinhAnh != ''} ? 'background-image: url(' + ${tournament.hinhAnh} + ');' : 'background: linear-gradient(135deg, #1A1A1A 0%, #2D2D2D 100%);'"
                 th:data-image="${tournament.hinhAnh}">
            </div>
            <div class="hero-overlay"></div>
            <div class="hero-content">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-lg-8">
                            <!-- Status Badge -->
                            <div th:if="${tournament.trangThai == 'ongoing'}" 
                                 class="tournament-badge badge-ongoing animated-badge">
                                <span class="badge-pulse"></span>
                                <i class="bi bi-broadcast"></i> ĐANG DIỄN RA
                            </div>
                            <div th:if="${tournament.trangThai == 'registration'}" 
                                 class="tournament-badge badge-registration animated-badge">
                                <span class="badge-pulse"></span>
                                <i class="bi bi-pencil-square"></i> ĐANG ĐĂNG KÝ
                            </div>
                            <div th:if="${tournament.trangThai == 'upcoming'}" 
                                 class="tournament-badge badge-upcoming">
                                <i class="bi bi-clock"></i> SẮP DIỄN RA
                            </div>
                            <div th:if="${tournament.trangThai == 'completed'}" 
                                 class="tournament-badge badge-completed">
                                <i class="bi bi-check-circle"></i> ĐÃ KẾT THÚC
                            </div>

                            <h1 class="hero-title" th:text="${tournament.tenGiai}" data-aos="fade-up" data-aos-delay="100">
                                Tên Giải đấu
                            </h1>
                            <p class="hero-subtitle" th:text="${(tournament.diaDiem ?: tournament.tinhThanh ?: '') + (tournament.diaDiem != null or tournament.tinhThanh != null ? ', ' : '') + (tournament.quocGia ?: '')}" data-aos="fade-up" data-aos-delay="200">
                                Hà Nội, Việt Nam
                            </p>

                            <!-- Countdown Timer for Registration -->
                            <div th:if="${tournament.trangThai == 'registration'}" 
                                 class="countdown-timer" 
                                 id="countdownTimer" 
                                 th:data-deadline="${tournament.ngayDongDangKi}"
                                 data-aos="fade-up" 
                                 data-aos-delay="300">
                                <div class="countdown-label">
                                    <i class="bi bi-clock-history"></i> Hết hạn đăng ký sau:
                                </div>
                                <div class="countdown-boxes">
                                    <div class="countdown-box">
                                        <span class="countdown-value" id="days">00</span>
                                        <span class="countdown-unit">Ngày</span>
                                    </div>
                                    <div class="countdown-separator">:</div>
                                    <div class="countdown-box">
                                        <span class="countdown-value" id="hours">00</span>
                                        <span class="countdown-unit">Giờ</span>
                                    </div>
                                    <div class="countdown-separator">:</div>
                                    <div class="countdown-box">
                                        <span class="countdown-value" id="minutes">00</span>
                                        <span class="countdown-unit">Phút</span>
                                    </div>
                                    <div class="countdown-separator">:</div>
                                    <div class="countdown-box">
                                        <span class="countdown-value" id="seconds">00</span>
                                        <span class="countdown-unit">Giây</span>
                                    </div>
                                </div>
                            </div>

                            <div class="action-buttons" data-aos="fade-up" data-aos-delay="400">
                                <a th:if="${tournament.trangThai == 'registration'}"
                                   th:href="@{/tournaments/{id}/register(id=${tournament.id})}"
                                   class="btn btn-success btn-lg pulse-btn">
                                    <i class="bi bi-pencil-square"></i> Đăng ký tham gia
                                </a>
                                <a th:if="${tournament.trangThai == 'ongoing'}"
                                   th:href="@{/tournaments/{id}/live(id=${tournament.id})}"
                                   class="btn btn-danger btn-lg pulse-btn">
                                    <i class="bi bi-broadcast"></i> Xem LIVE
                                </a>
                                <a th:href="@{/tournaments/{id}/schedule(id=${tournament.id})}"
                                   class="btn btn-outline-light btn-lg">
                                    <i class="bi bi-calendar3"></i> Lịch thi đấu
                                </a>
                                <a th:href="@{/tournaments/{id}/standings(id=${tournament.id})}"
                                   class="btn btn-outline-light btn-lg">
                                    <i class="bi bi-trophy"></i> BXH
                                </a>
                            </div>
                        </div>

                        <!-- Social Share Sidebar -->
                        <div class="col-lg-4" data-aos="fade-left" data-aos-delay="500">
                            <div class="social-share-card">
                                <h5 class="share-title">
                                    <i class="bi bi-share"></i> Chia sẻ
                                </h5>
                                <div class="share-buttons">
                                    <button class="share-btn facebook" 
                                            onclick="shareFacebook()"
                                            title="Chia sẻ lên Facebook">
                                        <i class="bi bi-facebook"></i>
                                        <span>Facebook</span>
                                    </button>
                                    <button class="share-btn twitter" 
                                            onclick="shareTwitter()"
                                            title="Chia sẻ lên Twitter">
                                        <i class="bi bi-twitter"></i>
                                        <span>Twitter</span>
                                    </button>
                                    <button class="share-btn zalo" 
                                            onclick="shareZalo()"
                                            title="Chia sẻ qua Zalo">
                                        <i class="bi bi-chat-dots"></i>
                                        <span>Zalo</span>
                                    </button>
                                    <button class="share-btn copy" 
                                            onclick="copyLink()"
                                            title="Sao chép link">
                                        <i class="bi bi-link-45deg"></i>
                                        <span>Copy Link</span>
                                    </button>
                                </div>
                                <div class="copy-success" id="copySuccess" style="display: none;">
                                    <i class="bi bi-check-circle"></i> Đã sao chép link!
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scroll Down Indicator -->
            <div class="scroll-indicator" data-aos="fade-up" data-aos-delay="600">
                <span>Cuộn xuống</span>
                <i class="bi bi-chevron-down"></i>
            </div>
        </div>

        <div class="container">
            <!-- Info Cards -->
            <div class="info-cards">
                <div class="row g-4">
                    <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="0">
                        <div class="info-card">
                            <i class="bi bi-calendar-event info-icon"></i>
                            <div class="info-label">Thời gian</div>
                            <div class="info-value" th:text="${#temporals.format(tournament.ngayBatDau, 'dd/MM/yyyy')}">
                                01/03/2024
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="100">
                        <div class="info-card">
                            <i class="bi bi-geo-alt info-icon"></i>
                            <div class="info-label">Địa điểm</div>
                            <div class="info-value" th:text="${tournament.tinhThanh ?: 'Chưa xác định'}">
                                Hà Nội
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="200">
                        <div class="info-card">
                            <i class="bi bi-people info-icon"></i>
                            <div class="info-label">Số VĐV</div>
                            <div class="info-value" th:text="${tournament.soLuongToiDa != null ? (tournament.soLuongToiDa + ' VĐV') : 'Không giới hạn'}">
                                128 VĐV
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="300">
                        <div class="info-card">
                            <i class="bi bi-cash-stack info-icon"></i>
                            <div class="info-label">Giải thưởng</div>
                            <div class="info-value" th:text="${tournament.giaiThuong ?: 'Đang cập nhật'}">
                                500 triệu VNĐ
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Registration Alert -->
            <div th:if="${tournament.trangThai == 'registration'}" 
                 class="alert alert-registration mt-4" 
                 data-aos="fade-up">
                <h5 class="alert-heading">
                    <i class="bi bi-megaphone"></i> Đăng ký tham gia ngay!
                </h5>
                <p class="mb-0">
                    Giải đấu đang mở đăng ký<span th:if="${tournament.ngayDongDangKi != null}"> đến ngày <strong th:text="${#temporals.format(tournament.ngayDongDangKi, 'dd/MM/yyyy')}">20/02/2024</strong></span>. 
                    Số chỗ có hạn, đăng ký sớm để đảm bảo suất tham gia!
                </p>
            </div>

            <!-- Main Content -->
            <div class="content-section" data-aos="fade-up">
                <!-- Tabs Navigation -->
                <ul class="nav nav-tabs" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" data-bs-toggle="tab" href="#overview">
                            <i class="bi bi-info-circle"></i> Tổng quan
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#details">
                            <i class="bi bi-list-ul"></i> Chi tiết
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#bracket">
                            <i class="bi bi-diagram-3"></i> Bảng đấu
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#rules">
                            <i class="bi bi-file-text"></i> Thể lệ
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#contact">
                            <i class="bi bi-telephone"></i> Liên hệ
                        </a>
                    </li>
                </ul>

                <!-- Tabs Content -->
                <div class="tab-content">
                    <!-- Overview Tab -->
                    <div class="tab-pane fade show active" id="overview">
                        <h3>Giới thiệu</h3>
                        <div class="tournament-description" th:utext="${tournament.moTa}">
                            <p>Mô tả chi tiết về giải đấu sẽ được hiển thị ở đây.</p>
                        </div>

                        <div class="row mt-4">
                            <div class="col-md-6">
                                <h5>Điểm nổi bật</h5>
                                <ul class="list-unstyled">
                                    <li><i class="bi bi-check-circle text-success"></i> Quy mô lớn, chuyên nghiệp</li>
                                    <li><i class="bi bi-check-circle text-success"></i> Giải thưởng hấp dẫn</li>
                                    <li><i class="bi bi-check-circle text-success"></i> Cơ sở vật chất hiện đại</li>
                                    <li><i class="bi bi-check-circle text-success"></i> Ban tổ chức chuyên nghiệp</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5>Các nội dung thi đấu</h5>
                                <ul class="list-unstyled">
                                    <li><i class="bi bi-trophy text-warning"></i> Đơn Nam</li>
                                    <li><i class="bi bi-trophy text-warning"></i> Đơn Nữ</li>
                                    <li><i class="bi bi-trophy text-warning"></i> Đôi Nam</li>
                                    <li><i class="bi bi-trophy text-warning"></i> Đôi Nữ</li>
                                    <li><i class="bi bi-trophy text-warning"></i> Đôi Nam Nữ</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Image Gallery -->
                        <div class="gallery-section mt-5" th:if="${tournament.gallery != null and !tournament.gallery.isEmpty()}">
                            <h5><i class="bi bi-images"></i> Hình ảnh giải đấu</h5>
                            <div class="row g-3 gallery-grid">
                                <div th:each="image, iterStat : ${tournament.gallery}" 
                                     th:if="${image.loai == 'image'}"
                                     class="col-md-4 col-sm-6 gallery-item"
                                     th:data-index="${iterStat.index}">
                                    <div class="gallery-card" th:onclick="'openLightbox(' + ${iterStat.index} + ')'">
                                        <img th:src="${image.url}" 
                                             th:alt="${image.tieuDe}"
                                             class="gallery-image"
                                             loading="lazy">
                                        <div class="gallery-overlay">
                                            <i class="bi bi-zoom-in"></i>
                                            <span th:text="${image.tieuDe}">Image Title</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Details Tab -->
                    <div class="tab-pane fade" id="details">
                        <h3>Thông tin chi tiết</h3>
                        <ul class="detail-list">
                            <li>
                                <span class="detail-label">Loại giải:</span>
                                <span class="detail-value" th:text="${tournament.capDo ?: 'Không phân loại'}">Professional</span>
                            </li>
                            <li>
                                <span class="detail-label">Thời gian:</span>
                                <span class="detail-value" th:text="${#temporals.format(tournament.ngayBatDau, 'dd/MM/yyyy') + ' - ' + #temporals.format(tournament.ngayKetThuc, 'dd/MM/yyyy')}">01/03 - 15/03/2024</span>
                            </li>
                            <li>
                                <span class="detail-label">Địa điểm:</span>
                                <span class="detail-value" th:text="${tournament.tinhThanh ?: 'Chưa xác định'}">Hà Nội</span>
                            </li>
                            <li>
                                <span class="detail-label">Địa chỉ chi tiết:</span>
                                <span class="detail-value" th:text="${tournament.sanThiDau ?: 'Chưa xác định'}">Cung thể thao Quần Ngựa</span>
                            </li>
                            <li>
                                <span class="detail-label">Số VĐV tối đa:</span>
                                <span class="detail-value" th:text="${tournament.soLuongToiDa ?: 'Không giới hạn'}">128</span>
                            </li>
                            <li>
                                <span class="detail-label">Giải thưởng:</span>
                                <span class="detail-value" th:text="${tournament.giaiThuong ?: 'Đang cập nhật'}">500 triệu VNĐ</span>
                            </li>
                            <li>
                                <span class="detail-label">Hạn đăng ký:</span>
                                <span class="detail-value" th:text="${tournament.ngayDongDangKi != null ? #temporals.format(tournament.ngayDongDangKi, 'dd/MM/yyyy') : 'Chưa xác định'}">20/02/2024</span>
                            </li>
                            <li>
                                <span class="detail-label">Lệ phí:</span>
                                <span class="detail-value" th:text="${tournament.phiThamGia != null ? (#numbers.formatDecimal(tournament.phiThamGia, 0, 'COMMA', 0, 'POINT') + ' VNĐ') : 'Miễn phí'}">500.000 VNĐ</span>
                            </li>
                        </ul>
                    </div>

                    <!-- Rules Tab -->
                    <div class="tab-pane fade" id="rules">
                        <h3>Thể lệ giải đấu</h3>
                        <div class="tournament-description">
                            <h5>1. Điều kiện tham dự</h5>
                            <p>VĐV phải đáp ứng các yêu cầu về tuổi, trình độ và giấy tờ theo quy định.</p>

                            <h5>2. Thể thức thi đấu</h5>
                            <p>Áp dụng luật thi đấu cầu lông quốc tế BWF mới nhất.</p>

                            <h5>3. Quy định về trang phục</h5>
                            <p>VĐV phải mặc trang phục thể thao phù hợp, không có hình ảnh, văn bản vi phạm.</p>

                            <h5>4. Kỷ luật</h5>
                            <p>Vi phạm kỷ luật sẽ bị xử lý theo quy định, có thể bị loại khỏi giải.</p>

                            <a th:href="@{/tournaments/{id}/rules(id=${tournament.id})}" 
                               class="btn btn-primary mt-3">
                                <i class="bi bi-file-earmark-text"></i> Xem đầy đủ thể lệ
                            </a>
                        </div>
                    </div>

                    <!-- Bracket Tab -->
                    <div class="tab-pane fade" id="bracket">
                        <div class="bracket-header mb-4">
                            <h3><i class="bi bi-table"></i> Sơ đồ thi đấu</h3>
                        </div>
                        
                        <!-- Category Tabs -->
                        <div class="bracket-category-tabs" id="bracketCategoryTabs">
                            <!-- Category tabs will be rendered by JS -->
                        </div>
                        
                        <!-- Loading State -->
                        <div class="bracket-loading text-center py-5" id="bracketLoading">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Đang tải...</span>
                            </div>
                            <p class="mt-3 text-muted">Đang tải sơ đồ thi đấu...</p>
                        </div>
                        
                        <!-- Bracket Table View -->
                        <div class="bracket-table-container" id="bracketTableContainer" style="display: none;">
                            <div class="table-responsive">
                                <table class="table schedule-table">
                                    <thead>
                                        <tr>
                                            <th>Vòng</th>
                                            <th>Ngày</th>
                                            <th>Giờ</th>
                                            <th class="text-end">VĐV 1</th>
                                            <th class="text-center">Tỉ số</th>
                                            <th>VĐV 2</th>
                                            <th class="text-center">Trạng thái</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bracketTableBody">
                                        <!-- Data will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- Empty State -->
                        <div class="bracket-empty text-center py-5" id="bracketEmpty" style="display: none;">
                            <i class="bi bi-diagram-3 text-muted" style="font-size: 3rem;"></i>
                            <p class="mt-3 text-muted">Chưa có dữ liệu sơ đồ thi đấu</p>
                            <p class="text-muted small">Vui lòng tạo sơ đồ từ ứng dụng quản lý giải đấu</p>
                        </div>
                    </div>

                    <!-- Contact Tab -->
                    <div class="tab-pane fade" id="contact">
                        <h3>Thông tin liên hệ</h3>
                        <ul class="detail-list">
                            <li>
                                <span class="detail-label">
                                    <i class="bi bi-building"></i> Ban tổ chức:
                                </span>
                                <span class="detail-value">
                                    Liên đoàn Cầu lông Việt Nam
                                </span>
                            </li>
                            <li>
                                <span class="detail-label">
                                    <i class="bi bi-telephone"></i> Hotline:
                                </span>
                                <span class="detail-value" th:text="${tournament.dienThoai ?: 'Chưa cập nhật'}">
                                    024-1234-5678
                                </span>
                            </li>
                            <li>
                                <span class="detail-label">
                                    <i class="bi bi-envelope"></i> Email:
                                </span>
                                <span class="detail-value" th:text="${tournament.email ?: 'Chưa cập nhật'}">
                                    contact@tournament.vn
                                </span>
                            </li>
                            <li>
                                <span class="detail-label">
                                    <i class="bi bi-globe"></i> Website:
                                </span>
                                <span class="detail-value">
                                    <a th:href="${tournament.website}" 
                                       th:text="${tournament.website}"
                                       target="_blank">
                                        https://tournament.vn
                                    </a>
                                </span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Related Tournaments -->
            <!-- Related Tournaments Carousel -->
            <div class="related-tournaments" th:if="${relatedTournaments != null and !relatedTournaments.empty}">
                <div class="d-flex justify-content-between align-items-center mb-4" data-aos="fade-up">
                    <h3 class="mb-0">
                        <i class="bi bi-collection"></i> Giải đấu liên quan
                    </h3>
                    <div class="swiper-navigation">
                        <button class="swiper-button-prev-custom">
                            <i class="bi bi-chevron-left"></i>
                        </button>
                        <button class="swiper-button-next-custom">
                            <i class="bi bi-chevron-right"></i>
                        </button>
                    </div>
                </div>
                
                <div class="swiper relatedTournamentsSwiper" data-aos="fade-up" data-aos-delay="100">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide" th:each="related : ${relatedTournaments}">
                            <a th:href="@{/tournaments/{id}(id=${related.id})}" 
                               class="text-decoration-none">
                                <div class="related-tournament-card">
                                    <div class="related-tournament-image">
                                        <img th:src="${related.hinhAnh}" 
                                             th:alt="${related.tenGiai}"
                                             loading="lazy"
                                             onerror="this.src='/icons/tournaments/default.jpg'">
                                        <div class="tournament-badge-overlay" 
                                             th:if="${related.trangThai == 'registration'}">
                                            <span class="badge bg-success">Đang đăng ký</span>
                                        </div>
                                    </div>
                                    <div class="related-tournament-body">
                                        <h5 class="related-tournament-title" th:text="${related.tenGiai}">
                                            Tên giải đấu
                                        </h5>
                                        <div class="related-tournament-meta">
                                            <div class="meta-item">
                                                <i class="bi bi-calendar3"></i>
                                                <span th:text="${#temporals.format(related.ngayBatDau, 'dd/MM/yyyy')}">01/03/2024</span>
                                            </div>
                                            <div class="meta-item">
                                                <i class="bi bi-geo-alt"></i>
                                                <span th:text="${related.tinhThanh ?: 'TBA'}">Hà Nội</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="swiper-pagination"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lightbox Modal -->
    <div class="modal fade" id="lightboxModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-xl">
            <div class="modal-content bg-dark">
                <div class="modal-header border-0">
                    <h5 class="modal-title text-white" id="lightboxTitle">Image</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center p-0">
                    <img id="lightboxImage" src="" alt="" class="img-fluid w-100">
                    <div class="lightbox-controls">
                        <button class="btn btn-light btn-sm" onclick="prevImage()">
                            <i class="bi bi-chevron-left"></i> Trước
                        </button>
                        <span class="text-white mx-3" id="lightboxCounter">1 / 1</span>
                        <button class="btn btn-light btn-sm" onclick="nextImage()">
                            Sau <i class="bi bi-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Page-specific JavaScript -->
    <th:block layout:fragment="page-scripts">
        <!-- Swiper JS -->
        <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
        <script th:src="@{/js/tournament/tournament-detail.js(v=${#temporals.format(#temporals.createNow(), 'yyyyMMddHHmmss')})}"></script>
        <script th:src="@{/js/tournament/tournament-bracket.js(v=${#temporals.format(#temporals.createNow(), 'yyyyMMddHHmmss')})}"></script>
        <script th:inline="javascript">
            // Auto-load bracket when tab is shown
            document.addEventListener('DOMContentLoaded', function() {
                const bracketTab = document.querySelector('a[href="#bracket"]');
                const tournamentId = /*[[${tournament.id}]]*/ 0;
                let bracketInstance = null;
                
                // Function to load bracket
                function loadBracketData() {
                    if (tournamentId && window.TournamentBracket) {
                        if (!bracketInstance) {
                            bracketInstance = new TournamentBracket();
                        }
                        console.log('Loading bracket for tournament:', tournamentId);
                        bracketInstance.loadBracket(tournamentId);
                    } else {
                        console.warn('TournamentBracket not available or no tournamentId');
                    }
                }
                
                if (bracketTab) {
                    // Load bracket when tab is shown (via click)
                    bracketTab.addEventListener('shown.bs.tab', function() {
                        loadBracketData();
                    });
                    
                    // Check if bracket tab is active on page load (from URL hash)
                    const hash = window.location.hash;
                    if (hash === '#bracket') {
                        // Wait for Bootstrap tabs to initialize and activate tab
                        setTimeout(function() {
                            // Trigger tab click to activate
                            const bsTab = new bootstrap.Tab(bracketTab);
                            bsTab.show();
                            loadBracketData();
                        }, 300);
                    }
                }
            });
        </script>
    </th:block>
</body>
</html>
